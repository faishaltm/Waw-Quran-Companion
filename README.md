# Waw Quran Companion Bot

This project is a Python-based Telegram bot designed for in-depth Quranic analysis. It provides users with detailed linguistic and contextual information for verses of the Quran, leveraging a rich, pre-generated dataset. The bot is interactive, allowing users to navigate through surahs and verses to explore the Quran's text, translation, morphology, rhetoric (balaghah), and commentary (tafsir).

## Features

- **Interactive Quran Navigation:** Explore the Quran by surah and verse.
- **Detailed Verse Analysis:** Get comprehensive linguistic information for each verse, including morphology, syntactic dependencies, and named entities.
- **Rhetorical Analysis (Balaghah):** Discover rhetorical devices used in the Quranic text.
- **Contextual Information:** Access reasons for revelation (Asbab al-Nuzul) and commentary (Tafsir).
- **Git LFS Integration:** The project uses Git Large File Storage (LFS) to handle the large dataset, keeping the main repository lightweight.

## Project Structure

```
quran/
├── data/                 # Contains all the raw and processed data
│   ├── linguistic/
│   ├── metadata/
│   ├── text/
│   └── quran_comprehensive.json  # The main, generated data file (handled by Git LFS)
├── scripts/
│   ├── deployment/       # Main application and deployment scripts
│   │   ├── api/          # Core logic for data loading, session management, etc.
│   │   ├── quran_telegram_bot.py # The main Telegram bot script
│   │   └── requirements.txt      # Python dependencies
│   └── tools/
│       └── generate_comprehensive_quran.py # Script to generate the main data file
└── README.md             # This file
```

## Setup and Installation

### Prerequisites

- Python 3.10+
- Git
- [Git Large File Storage (LFS)](https://git-lfs.github.com/)

### Step-by-Step Instructions

1.  **Clone the Repository:**
    Clone the repository to your local machine. Git LFS will automatically download the large `quran_comprehensive.json` file.

    ```bash
    git clone https://github.com/faishaltm/Waw-Quran-Companion.git
    cd Waw-Quran-Companion
    ```

2.  **Install Dependencies:**
    Install the required Python packages using pip.

    ```bash
    pip install -r scripts/deployment/requirements.txt
    ```

3.  **Set up the `.env` File:**
    Create a `.env` file in the `scripts/deployment/` directory. You can copy the example file and then add your credentials.

    ```bash
    cp scripts/deployment/.env.example scripts/deployment/.env
    ```

    Now, edit the `scripts/deployment/.env` file with your actual API keys:

    ```
    OPENAI_API_KEY=<your-openai-api-key>
    TELEGRAM_BOT_TOKEN=<your-telegram-bot-token>
    ```

## Data Generation

The core of this project is the `quran_comprehensive.json` file, which is generated by merging multiple data sources. The generation script is located in the `scripts/tools/` directory.

### Source Files

The generation script uses various files from the `data/` directory, including:
- Quranic text and translations
- Morphological and linguistic data
- Chapter metadata and tafsir indexes

### Generating the `quran_comprehensive.json` File

To generate the `quran_comprehensive.json` file, run the following command from the root of the project:

```bash
python scripts/tools/generate_comprehensive_quran.py
```

This script will read all the source files, process them, and generate the final `quran_comprehensive.json` file in the `data/` directory.

## Running the Bot

To start the Telegram bot, run the following command from the root of the project:

```bash
python scripts/deployment/quran_telegram_bot.py
```

The bot will start polling for messages from Telegram.

## Usage

You can interact with the bot using the following commands:

- `/start`: Start the bot and get a welcome message.
- `/help`: Get a list of available commands.
- `/surah <number>`: Start a new session with the specified surah.
- `/next` or `/n`: Analyze the next verse in the current surah.
- `/verse <number>`: Jump to and analyze a specific verse in the current surah.
- `/status`: Get the status of the current session.
- `/clear`: Clear the current conversation history.
- `/cancel`: Cancel the current session.

## Development Conventions

- The project follows a structured layout, separating data, scripts, and documentation.
- Python type hints are used for better code quality and maintainability.
- The project uses environment variables for configuration, loaded from a `.env` file.
